(this.webpackJsonpmyweb=this.webpackJsonpmyweb||[]).push([[0],{229:function(e,t,n){},397:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(30),i=n.n(r),o=(n(229),n(230),n(41)),s=n.n(o),l=n(65),d=n(406),u=n(401),j=n(402),b=n(84),h=n(107);n(398),n(231),n(399);h.a.initializeApp({apiKey:"AIzaSyDaEekDUR-2gbWW_s3WJhJAk6uLs_juEiY",authDomain:"app-chat-1449a.firebaseapp.com",projectId:"app-chat-1449a",storageBucket:"app-chat-1449a.appspot.com",messagingSenderId:"142216938529",appId:"1:142216938529:web:ebadc94ef6da4bccc60f60",measurementId:"G-G4YQQ8J1ZB"}),h.a.analytics();var p=h.a.auth(),m=h.a.firestore(),O=h.a,x=n(11),f=n(3),v=function(e,t){m.collection(e).add(Object(f.a)(Object(f.a)({},t),{},{createdAt:O.firestore.FieldValue.serverTimestamp()}))},g=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],r=[],i=0;i<n;i++)a[i]=!1;return function e(i){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[i]=t[o],i===n-1&&r.push(c.join(" ")),e(i+1),a[o]=!1)}(0),r.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(x.a)(e),Object(x.a)(n))}),[])},y=n(6),C=d.a.Title,I=new O.auth.FacebookAuthProvider;var N=function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.auth().signInWithPopup(I);case 2:t=e.sent,n=t.additionalUserInfo,a=t.user,v("user",{displayName:a.displayName,email:a.email,photoURL:a.photoURL,uid:a.uid,providerId:n.providerId,keywords:g(a.displayName)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(u.a,{justify:"center",style:{height:800},children:Object(y.jsxs)(j.a,{span:8,children:[Object(y.jsx)(C,{style:{textAlign:"center"},Level:3,children:"WEB CHAT"}),Object(y.jsx)(b.a,{style:{width:"100%",marginBottom:5},children:"LOGIN WITH GOOGLE"}),Object(y.jsx)(b.a,{style:{width:"100%"},onClick:e,children:"LOGIN WITH FACEBOOK"})]})})})},w=n(127),R=n(31),A=n(7),L=n(49),U=n(413),T=n(405),F=n(411),k=n(81),S=n(409),V=n(412),_=n(50),P=function(e,t){var n=Object(a.useState)([]),r=Object(A.a)(n,2),i=r[0],o=r[1];return c.a.useEffect((function(){var n=m.collection(e).orderBy("createdAt");if(t){if(!t.compareValue||!t.compareValue.length)return;n=n.where(t.fieldName,t.operator,t.compareValue)}return n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(f.a)(Object(f.a)({},e.data()),{},{id:e.id})}));o(t)}))}),[e,t]),i},M=n(403),D=c.a.createContext();function E(e){var t=e.children,n=Object(a.useState)(!0),r=Object(A.a)(n,2),i=r[0],o=r[1],s=Object(a.useState)({}),l=Object(A.a)(s,2),d=l[0],u=l[1],j=Object(R.f)();return c.a.useEffect((function(){var e=O.auth().onAuthStateChanged((function(e){if(console.log({user:e}),e){o(!1);var t=e.displayName,n=e.photoURL,a=e.email,c=e.uid;return u({displayName:t,photoURL:n,email:a,uid:c}),void j.push("/")}}));return o(!1),j.push("/login"),function(){e()}}),[j]),Object(y.jsx)(D.Provider,{value:{user:d},children:i?Object(y.jsx)(M.a,{children:"Loading...."}):t})}var B=c.a.createContext();function z(e){var t=e.children,n=Object(a.useState)(!1),r=Object(A.a)(n,2),i=r[0],o=r[1],s=Object(a.useState)(!1),l=Object(A.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)(""),b=Object(A.a)(j,2),h=b[0],p=b[1],m=c.a.useContext(D).user.uid,O=c.a.useMemo((function(){return{fieldName:"members",operator:"array-contains",compareValue:m}}),[m]),x=P("rooms",O);console.log({rooms:x});var f=Object(a.useMemo)((function(){return x.find((function(e){return e.id===h}))||{}}),[x,h]),v=c.a.useMemo((function(){return{fieldName:"uid",operator:"in",compareValue:f.members}}),[f.members]),g=P("user",v);return console.log({members:g,setlectedMember:f.members}),Object(y.jsx)(B.Provider,{value:{rooms:x,isAddRoomVisible:i,setIsAddRoomVisible:o,selectedRoomId:h,setSelectedRoomId:p,selectedRoom:f,members:g,isInvite:d,setIsInvite:u},children:t})}var G,W,J,H,K,Q,Y,X=n(404),Z=_.a.div(G||(G=Object(L.a)(["\n    margin-bottom:10px;\n    .Author{\n        margin-left:5px;\n        font-weight: bold;\n    };\n    .Date{\n        margin-left:10px;\n        font-size:11px;\n        color:#a7a7a7;\n    }\n    .Content{\n        margin-left: 30px;\n    }\n"])));function q(e){var t="";return e&&(t=(t=Object(X.a)(new Date(1e3*e),new Date)).charAt(0).toUpperCase()+t.slice(1)),q}function $(e){var t,n=e.text,a=e.displayName,c=e.createdAt,r=e.photoURL;return Object(y.jsxs)(Z,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(F.a,{size:"small",src:r,children:r?"":null===a||void 0===a||null===(t=a.charAt(0))||void 0===t?void 0:t.toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"Author",children:a}),Object(y.jsx)(d.a.Text,{className:"Date",children:q(null===c||void 0===c?void 0:c.seconds)})]}),Object(y.jsx)("div",{children:Object(y.jsx)(d.a.Text,{className:"Content",children:n})})]})}var ee,te=_.a.div(W||(W=Object(L.a)(["\n    display:flex;\n    justify-content:space-between;\n    height:56px;\n    padding: 0 16px;\n    border-bottom: 1px solid rgba(230, 230, 230);\n\n    .header{\n        &__info{\n            display: flex;\n            flex-direction: column;\n            justify-content:center;\n        }\n\n        &__title{\n            margin: 0;\n            font-weight:bold;\n        }\n        &__description{\n            font-size:12px;\n        }\n    }\n"]))),ne=_.a.div(J||(J=Object(L.a)(["\ndisplay: flex;\nalign-items:center;\n"]))),ae=_.a.div(H||(H=Object(L.a)(["\nheight: calc(100% - 56px);\ndisplay:flex;\nflex-direction: column;\npadding: 11px;\njustify-content: flex-end;\n"]))),ce=_.a.div(K||(K=Object(L.a)(["\nmax-height:100%;\noverflow-y: auto;\n"]))),re=_.a.div(Q||(Q=Object(L.a)(["\nheight:100vh;\n"]))),ie=Object(_.a)(T.a)(Y||(Y=Object(L.a)(["\n    display:flex;\n    justify-content:space-between;\n    align-items: center;\n    padding: 2px 2px 2px 0px;\n    border: 1px solid rgb(230,230,230);\n    border-radius:2px;\n\n    .ant-form-item{\n        flex:1;\n        margin-bottom:0;\n    }\n"]))),oe=function(){var e=Object(a.useContext)(D).user,t=e.uid,n=e.photoURL,c=e.displayName,r=Object(a.useContext)(B),i=r.selectedRoom,o=r.members,s=r.setIsInvite,l=Object(a.useState)(""),d=Object(A.a)(l,2),u=d[0],j=d[1],h=T.a.useForm(),p=Object(A.a)(h,1)[0],m=function(){v("message",{text:u,uid:t,photoURL:n,roomId:i.id,displayName:c}),p.resetFields(["message"])},O=(Object(a.useMemo)((function(){return i.id,[i.id]})),P("message"));return Object(y.jsx)(re,{children:i.id?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(te,{children:[Object(y.jsxs)("div",{className:"header__info",children:[Object(y.jsx)("p",{className:"header__title",children:i.name}),Object(y.jsxs)("span",{className:"header__description",children:[i.description," "]})]}),Object(y.jsx)(ne,{children:Object(y.jsxs)("div",{children:[Object(y.jsx)(b.a,{icon:Object(y.jsx)(U.a,{}),onClick:function(){return s(!0)},type:"text",children:"M\u1eddi"}),Object(y.jsx)(F.a.Group,{size:"small",maxCount:3,children:o.map((function(e){var t;return Object(y.jsx)(k.a,{title:e.displayName,children:Object(y.jsx)(F.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t?void 0:t.charAt(0).toUpperCase()})},e.id)}))})]})})]}),Object(y.jsxs)(ae,{children:[Object(y.jsx)(ce,{children:O.map((function(e){return Object(y.jsx)($,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createdAt:e.createdAt},e.id)}))}),Object(y.jsxs)(ie,{form:p,children:[Object(y.jsx)(T.a.Item,{name:"message",children:Object(y.jsx)(S.a,{onChange:function(e){j(e.target.value)},onPressEnter:m,placeholder:"nh\u1eadp tin nh\u1eafn",bordered:!1,autoComplete:"off"})}),Object(y.jsx)(b.a,{type:"primary",onClick:m,children:"G\u1eedi"})]})]})]}):Object(y.jsx)(V.a,{message:"H\xe3y Ch\u1ecdn Ph\xf2ng ",type:"info",showIcon:!0,style:{margin:"5px"},closable:!0})})},se=_.a.div(ee||(ee=Object(L.a)(["\n    display:flex;\n    justify-content:space-between;\n    padding : 12px 16px;\n    border-bottom: 1px solid rgba(82,38,83);\n    .Username{\n        color:white;\n        margin-left: 5px;\n    }\n"])));function le(){var e,t=c.a.useContext(D).user,n=t.displayName,a=t.photoURL;return Object(y.jsxs)(se,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(F.a,{src:a,children:a?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"Username",children:n})]}),Object(y.jsx)(b.a,{ghost:!0,onClick:function(){return p.signOut()},children:" \u0110\u0103ng Xu\u1ea5t"})]})}var de,ue,je,be=n(408),he=n(414),pe=be.a.Panel,me=Object(_.a)(pe)(de||(de=Object(L.a)(["\n    &&&{\n        .ant-collapse-header,p{\n            color:white;\n        }\n        .ant-collapae-content-box{\n            padding: 0 , 40px;\n        }\n    }\n"]))),Oe=Object(_.a)(d.a.Link)(ue||(ue=Object(L.a)(["\n    display:block;\n    margin-bottom: 5px;\n    color:white;\n"])));function xe(){var e=Object(a.useContext)(B),t=e.rooms,n=e.setIsAddRoomVisible,c=e.setSelectedRoomId;return Object(y.jsx)(be.a,{ghost:!0,defaultActiveKey:["1"],children:Object(y.jsxs)(me,{header:"Danh S\xe1ch Ph\xf2ng",children:[t.map((function(e){return Object(y.jsx)(Oe,{onClick:function(){return c(e.id)},children:e.name},e.id)})),Object(y.jsx)(b.a,{type:"text",icon:Object(y.jsx)(he.a,{}),onClick:function(){n(!0)},className:"add-room",children:"Th\xeam Ph\xf2ng"})]},"1")})}var fe=_.a.div(je||(je=Object(L.a)(["\n    background: #9e82df;\n    color : white;\n    height : 100vh;\n"])));function ve(){return Object(y.jsx)(fe,{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(le,{})}),Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(xe,{})})]})})}function ge(){return Object(y.jsx)("div",{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:6,children:Object(y.jsx)(ve,{})}),Object(y.jsx)(j.a,{span:18,children:Object(y.jsx)(oe,{})})]})})}var ye=n(410);function Ce(){var e=Object(a.useContext)(B),t=e.isAddRoomVisible,n=e.setIsAddRoomVisible,c=Object(a.useContext)(D).user.uid,r=T.a.useForm(),i=Object(A.a)(r,1)[0];return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)("div",{children:Object(y.jsx)(ye.a,{title:"T\u1ea1o Ph\xf2ng",visible:t,onOk:function(){console.log({formData:i.getFieldsValue()}),n(!1),v("rooms",Object(f.a)(Object(f.a)({},i.getFieldsValue()),{},{members:[c]})),i.resetFields()},onCancel:function(){i.resetFields(),n(!1)},children:Object(y.jsxs)(T.a,{form:i,children:[Object(y.jsx)(T.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(y.jsx)(S.a,{placeholder:"Nh\u1eadp T\xean Ph\xf2ng"})}),Object(y.jsx)(T.a.Item,{label:"N\u1ed9i Dung : ",name:"description",children:Object(y.jsx)(S.a.TextArea,{placeholder:"Nh\u1eadp M\xf4 T\u1ea3"})})]})})})})}var Ie=n(16),Ne=n(407),we=n(214),Re=n.n(we),Ae=n(212),Le=["fetchOptions","debounceTimeout"];function Ue(e){var t=e.fetchOptions,n=e.debounceTimeout,r=void 0===n?300:n,i=Object(Ie.a)(e,Le),o=Object(a.useState)(!1),s=Object(A.a)(o,2),l=s[0],d=s[1],u=Object(a.useState)([]),j=Object(A.a)(u,2),b=j[0],h=j[1],p=c.a.useMemo((function(){return Object(Ae.debounce)((function(e){h([]),d(!0),t(e,i.currentMembers).then((function(e){h(e),d(!1)}))}),r)}),[r,t]);return Object(y.jsx)(Ne.a,Object(f.a)(Object(f.a)({labelInValue:!0,filterOption:!1,onSearch:p,notFoundContent:l?Object(y.jsx)(M.a,{size:"small"}):null},i),{},{children:b.map((function(e){var t;return Object(y.jsxs)(Ne.a.Option,{value:e.value,title:e.label,children:[Object(y.jsx)(Re.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t?void 0:t.charAt(0).toUpperCase()}),"".concat(e.label)]},e.value)}))}))}function Te(e,t){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.collection("user").where("keywords","array-contains",t).orderBy("displayName").limit(10).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(){var e=Object(a.useState)([]),t=Object(A.a)(e,2),n=t[0],c=t[1],r=Object(a.useContext)(B),i=r.isInvite,o=r.setIsInvite,s=r.selectedRoomId,l=r.selectedRoom,d=(Object(a.useContext)(D).user.uid,T.a.useForm()),u=Object(A.a)(d,1)[0];return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)("div",{children:Object(y.jsx)(ye.a,{title:"M\u1eddi Th\xeam Th\xe0nh Vi\xean",visible:i,onOk:function(){u.resetFields();var e=m.collection("rooms").doc(s);o(!1),e.update({members:[].concat(Object(x.a)(l.members),Object(x.a)(n.map((function(e){return e.value}))))})},onCancel:function(){u.resetFields(),o(!1)},children:Object(y.jsx)(T.a,{form:u,layout:"vertical",children:Object(y.jsx)(Ue,{mode:"multiple",label:"T\xean C\xe1c Th\xe0nh Vi\xean",value:n,placeholder:"Nh\u1eadp t\xean b\u1ea1n mu\u1ed1n m\u1eddi v\xe0o \u0111\xea",fetchOptions:Te,onChange:function(e){return c(e)},style:{width:"100%"},currentMembers:l.members})})})})})}var Se=function(){return Object(y.jsx)("div",{className:"App",children:Object(y.jsx)(w.a,{children:Object(y.jsx)(E,{children:Object(y.jsxs)(z,{children:[Object(y.jsxs)(R.c,{children:[Object(y.jsx)(R.a,{component:N,path:"/login"}),Object(y.jsx)(R.a,{component:ge,path:"/"})]}),Object(y.jsx)(Ce,{}),Object(y.jsx)(ke,{})]})})})})},Ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,415)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(Se,{})}),document.getElementById("root")),Ve()}},[[397,1,2]]]);
//# sourceMappingURL=main.9997551e.chunk.js.map